# ===============================
# CONFIGURAÇÃO BÁSICA
# ===============================

# Mudar prefix de Ctrl+b para Ctrl+a (mais confortável)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Recarregar configuração com Prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display "Config recarregado!"

# Começar índice de janelas e painéis em 1 (não 0)
set -g base-index 1
setw -g pane-base-index 1

# Renumerar janelas automaticamente quando uma é fechada
set -g renumber-windows on

# Aumentar histórico de scroll
set -g history-limit 10000

# Mouse support (scroll, resize, select)
set -g mouse on

# Tempo de espera ESC (importante para Vim/Neovim)
set -sg escape-time 0

# ===============================
# CORES E APARÊNCIA
# ===============================

# Suporte a 256 cores
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Status bar no topo
set -g status-position top

# Atualizar status bar a cada 1 segundo
set -g status-interval 1

# ===============================
# KEYBINDINGS
# ===============================

# Dividir painéis - ERGONÔMICO para teclado BR
bind s split-window -h -c "#{pane_current_path}"  # s = side by side (vertical)
bind v split-window -v -c "#{pane_current_path}"  # v = vertical (horizontal)

unbind '"'
unbind %

# Fechar painel
bind q kill-pane                                   # q = quit (sem confirmação)
bind x confirm-before -p "Fechar painel? (y/n)" kill-pane  # x = com confirmação

# Navegar entre painéis com Alt+hjkl (SEM prefix)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Redimensionar painéis com Prefix + Shift+HJKL
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Zoom no painel (fullscreen toggle)
bind z resize-pane -Z

# Alternar layouts
bind Space next-layout

# Nova janela no diretório atual
bind c new-window -c "#{pane_current_path}"

# Trocar janelas com Prefix + n/p
bind n next-window
bind p previous-window

# Ir para janela específica
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9

# Renomear janela
bind , command-prompt -I "#W" "rename-window '%%'"

# Fechar janela
bind & confirm-before -p "Fechar janela? (y/n)" kill-window

# Copy mode estilo Vim
setw -g mode-keys vi
bind [ copy-mode                                   # Entrar em copy mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "wl-copy"
bind -T copy-mode-vi Escape send -X cancel

# ===============================
# TEMA CATPPUCCIN MOCHA
# ===============================

# Cores base Catppuccin Mocha
thm_bg="#1e1e2e"
thm_fg="#cdd6f4"
thm_cyan="#89dceb"
thm_black="#181825"
thm_gray="#313244"
thm_magenta="#cba6f7"
thm_pink="#f5c2e7"
thm_red="#f38ba8"
thm_green="#a6e3a1"
thm_yellow="#f9e2af"
thm_blue="#89b4fa"
thm_orange="#fab387"
thm_black4="#585b70"

# Status bar
set -g status-style "bg=${thm_bg},fg=${thm_fg}"

# Janela atual
setw -g window-status-current-style "bg=${thm_blue},fg=${thm_bg},bold"
setw -g window-status-current-format " #I:#W "

# Janelas inativas
setw -g window-status-style "bg=${thm_gray},fg=${thm_fg}"
setw -g window-status-format " #I:#W "

# Painéis
set -g pane-border-style "fg=${thm_gray}"
set -g pane-active-border-style "fg=${thm_blue}"

# Status bar esquerda (sessão)
set -g status-left "#[bg=${thm_green},fg=${thm_bg},bold] #S #[bg=${thm_bg}] "
set -g status-left-length 50

# Status bar direita (data/hora)
set -g status-right "#[bg=${thm_gray},fg=${thm_fg}] %d/%m/%Y #[bg=${thm_blue},fg=${thm_bg},bold] %H:%M:%S "
set -g status-right-length 50

# # ===============================
# # PLUGINS (TPM)
# # ===============================
#
# # Lista de plugins
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-resurrect'   # Salvar/restaurar sessões
# set -g @plugin 'tmux-plugins/tmux-continuum'   # Auto-save contínuo
#
# # Configuração tmux-resurrect
# set -g @resurrect-strategy-nvim 'session'      # Restaurar Neovim
# set -g @resurrect-capture-pane-contents 'on'   # Salvar conteúdo dos painéis
#
# # Configuração tmux-continuum
# set -g @continuum-restore 'on'                 # Restaurar automaticamente
# set -g @continuum-save-interval '15'           # Auto-save a cada 15 min
#
# # IMPORTANTE: Manter no final do arquivo
# run '~/.config/tmux/plugins/tpm/tpm'
